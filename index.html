<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Guess What? 2025</title>
    
    <!-- 1. è¼‰å…¥ React å’Œ ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- 2. è¼‰å…¥ Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- 3. è¼‰å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 4. è¼‰å…¥å­—é«” -->
    <link href="https://fonts.googleapis.com/css2?family=Titan+One&family=Nunito:wght@700;900&display=swap" rel="stylesheet">

    <!-- 5. è‡ªè¨‚æ¨£å¼ -->
    <style>
        body {
            background-color: #FBF6EF;
            font-family: 'Nunito', sans-serif;
            overflow: hidden; 
            touch-action: manipulation;
            user-select: none; /* é˜²æ­¢é•·æŒ‰é¸å–æ–‡å­— */
            -webkit-user-select: none;
        }
        .font-titan { font-family: 'Titan One', cursive; }
        
        .pattern-dots {
            background-image: radial-gradient(#D6CCC2 2px, transparent 2px);
            background-size: 20px 20px;
        }

        .brutal-shadow {
            box-shadow: 4px 4px 0px 0px rgba(0,0,0,1);
            border: 3px solid black;
        }
        .brutal-shadow:active {
            box-shadow: 2px 2px 0px 0px rgba(0,0,0,1);
            transform: translate(2px, 2px);
        }

        .text-stroke {
            -webkit-text-stroke: 1.5px black;
            paint-order: stroke fill;
        }
        .text-stroke-sm {
            -webkit-text-stroke: 0.8px black;
        }
    </style>
</head>
<body>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ICONS ---
        const Icons = {
            Play: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>,
            Check: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="4" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>,
            X: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="4" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>,
            RotateCcw: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 12" /><path d="M3 3v9h9" /></svg>,
            Trophy: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>,
            Clock: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
            Settings: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.1a2 2 0 0 1-1-1.72v-.51a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>,
            ArrowLeft: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>,
            HelpCircle: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/></svg>,
            Smartphone: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="14" height="20" x="5" y="2" rx="2" ry="2"/><path d="M12 18h.01"/></svg>
        };

        const CATEGORIES = [
            {
                id: 'pop-stars',
                title: 'Pop Stars',
                icon: 'ğŸ¤',
                color: 'bg-[#FF4D8D]',
                text: 'text-white',
                description: 'Icons of 2024-2025',
                words: ['Sabrina Carpenter', 'Chappell Roan', 'Charli XCX', 'Taylor Swift', 'Billie Eilish', 'Kendrick Lamar', 'Bad Bunny', 'The Weeknd', 'Bruno Mars', 'Lady Gaga', 'SZA', 'Tate McRae', 'Benson Boone', 'Teddy Swims', 'Shaboozey', 'Post Malone', 'Olivia Rodrigo', 'Dua Lipa', 'Ariana Grande', 'RosÃ©', 'Tyla', 'Ice Spice', 'Central Cee', 'Gracie Abrams', 'Harry Styles', 'Doja Cat', 'Miley Cyrus', 'BeyoncÃ©', 'Rihanna', 'Travis Scott']
            },
            {
                id: 'hit-songs',
                title: 'Hit Songs',
                icon: 'ğŸµ',
                color: 'bg-[#8B5CF6]',
                text: 'text-white',
                description: 'Viral Hits & Bops',
                words: ['Espresso', 'Good Luck, Babe!', 'Birds of a Feather', 'Not Like Us', 'Lose Control', 'Beautiful Things', 'A Bar Song (Tipsy)', 'Die With A Smile', 'Pink Pony Club', 'Hot to Go!', 'Apple', '360', 'Guess', 'Million Dollar Baby', 'Texas Hold \'Em', 'Fortnight', 'We Can\'t Be Friends', 'I Had Some Help', 'Lunch', 'Taste', 'Please Please Please', 'Diet Pepsi', 'Paint The Town Red', 'Vampire', 'Cruel Summer', 'Greedy', 'Stick Season', 'Too Sweet', 'Water', 'Snooze']
            },
            {
                id: 'movies',
                title: 'Movies',
                icon: 'ğŸ¬',
                color: 'bg-[#3B82F6]',
                text: 'text-white',
                description: 'Box Office 2025',
                words: ['Wicked', 'Gladiator II', 'Deadpool & Wolverine', 'Inside Out 2', 'Dune: Part Two', 'Challengers', 'Twisters', 'Beetlejuice Beetlejuice', 'Moana 2', 'Mufasa', 'Sonic 3', 'Superman (2025)', 'A Minecraft Movie', 'Captain America 4', 'Thunderbolts*', 'Snow White', 'Zootopia 2', 'Joker: Folie Ã  Deux', 'The Substance', 'Anora', 'Civil War', 'The Fall Guy', 'Kung Fu Panda 4', 'Godzilla x Kong', 'Kingdom of the Planet of the Apes', 'Furiosa', 'Despicable Me 4', 'Alien: Romulus', 'Nosferatu', 'Ballerina']
            },
            {
                id: 'viral',
                title: 'Viral',
                icon: 'ğŸ”¥',
                color: 'bg-[#10B981]',
                text: 'text-white',
                description: 'Trends & Brainrot',
                words: ['Skibidi Toilet', 'Rizz', 'Fanum Tax', 'Brainrot', 'Sigma', 'Mewing', 'Very Demure', 'Brat Summer', 'Pookie', 'Glazing', 'Yap / Yapping', 'Crash Out', 'Standing on Business', 'Grimace Shake', 'Baby Gronk', 'Livvy Dunne', 'Hawk Tuah Girl', 'TikTok Shop', 'Beige Flag', 'The Ick', 'Looksmaxxing', 'Mogging', 'GigaChad', 'Girl Dinner', 'Roman Empire', 'Karen', 'Bombastic Side Eye', 'Cap / No Cap', 'Delulu', 'Main Character Energy']
            },
            {
                id: 'streaming',
                title: 'Streaming',
                icon: 'ğŸ“º',
                color: 'bg-[#F43F5E]',
                text: 'text-white',
                description: 'Top TV Shows',
                words: ['The Bear', 'House of the Dragon', 'Stranger Things', 'Wednesday', 'The Last of Us', 'Bridgerton', 'Squid Game', 'Fallout', 'Baby Reindeer', 'Euphoria', 'Succession', 'The White Lotus', 'Yellowstone', 'Severance', 'One Piece', 'Outer Banks', 'Ginny & Georgia', 'Emily in Paris', 'Shogun', 'True Detective']
            },
            {
                id: 'brands',
                title: 'Brands',
                icon: 'ğŸ›ï¸',
                color: 'bg-[#F59E0B]',
                text: 'text-white',
                description: 'Hype Brands',
                words: ['Stanley Cup', 'TikTok', 'Shein', 'Temu', 'ChatGPT', 'Tesla', 'Prime', 'Spotify', 'Netflix', 'Discord', 'Roblox', 'Fortnite', 'Instagram', 'Crocs', 'Lululemon', 'Sephora', 'Erewhon', 'Starbucks', 'Nike', 'Apple Vision Pro']
            }
        ];

        function App() {
            const [gameState, setGameState] = useState('menu'); 
            const [currentCategory, setCurrentCategory] = useState(null);
            const [gameWords, setGameWords] = useState([]);
            const [currentIndex, setCurrentIndex] = useState(0);
            const [score, setScore] = useState(0);
            const [timeLeft, setTimeLeft] = useState(60);
            const [results, setResults] = useState([]); 
            const [settings, setSettings] = useState({ duration: 60, tiltEnabled: true });
            const [showSettings, setShowSettings] = useState(false);
            const [showTutorial, setShowTutorial] = useState(false);
            
            // Ref for tilt logic debounce
            const isProcessingTilt = useRef(false);
            const tiltNeutral = useRef(true); // Is phone currently in "middle" position?

            const timerRef = useRef(null);
            const audioContextRef = useRef(null);

            const playSound = (type) => {
                if (!audioContextRef.current) {
                    audioContextRef.current = new (window.AudioContext || window.webkitAudioContext)();
                }
                const ctx = audioContextRef.current;
                const osc = ctx.createOscillator();
                const gainNode = ctx.createGain();
                osc.connect(gainNode);
                gainNode.connect(ctx.destination);
                
                const now = ctx.currentTime;

                if (type === 'correct') {
                    osc.type = 'triangle';
                    osc.frequency.setValueAtTime(500, now);
                    osc.frequency.linearRampToValueAtTime(1000, now + 0.1);
                    gainNode.gain.setValueAtTime(0.3, now);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
                    osc.start(); osc.stop(now + 0.3);
                } else if (type === 'pass') {
                    osc.type = 'sawtooth';
                    osc.frequency.setValueAtTime(200, now);
                    osc.frequency.linearRampToValueAtTime(100, now + 0.2);
                    gainNode.gain.setValueAtTime(0.3, now);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
                    osc.start(); osc.stop(now + 0.3);
                } else if (type === 'end') {
                    osc.type = 'triangle';
                    osc.frequency.setValueAtTime(600, now);
                    osc.frequency.linearRampToValueAtTime(200, now + 0.5);
                    gainNode.gain.setValueAtTime(0.5, now);
                    gainNode.gain.linearRampToValueAtTime(0, now + 1);
                    osc.start(); osc.stop(now + 1);
                }
            };

            const shuffleArray = (array) => {
                const newArray = [...array];
                for (let i = newArray.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
                }
                return newArray;
            };

            const startGame = (category) => {
                setCurrentCategory(category);
                setGameWords(shuffleArray(category.words));
                setCurrentIndex(0);
                setScore(0);
                setResults([]);
                setTimeLeft(settings.duration);
                setGameState('ready');
            };

            // --- è«‹æ±‚å‹•ä½œæ¬Šé™ (iOS 13+ éœ€è¦) ---
            const requestMotionPermission = async () => {
                if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === 'function') {
                    try {
                        const response = await DeviceOrientationEvent.requestPermission();
                        if (response === 'granted') {
                            return true;
                        } else {
                            alert('éœ€è¦å‹•ä½œæ¬Šé™æ‰èƒ½ä½¿ç”¨é«”æ„Ÿæ§åˆ¶å–”ï¼');
                            return false;
                        }
                    } catch (e) {
                        console.error(e);
                        return false;
                    }
                }
                return true; // Android or non-iOS 13+ usually allows by default
            };

            const handleStartPlaying = async () => {
                if (settings.tiltEnabled) {
                    await requestMotionPermission();
                }
                setGameState('playing');
            };

            // --- éŠæˆ²é‚è¼¯ ---
            useEffect(() => {
                if (gameState === 'playing') {
                    timerRef.current = setInterval(() => {
                        setTimeLeft((prev) => {
                            if (prev <= 1) {
                                clearInterval(timerRef.current);
                                playSound('end');
                                setGameState('results');
                                return 0;
                            }
                            return prev - 1;
                        });
                    }, 1000);
                }
                return () => clearInterval(timerRef.current);
            }, [gameState]);

            // --- éµç›¤èˆ‡é«”æ„Ÿåµæ¸¬ ---
            useEffect(() => {
                if (gameState !== 'playing') return;

                const handleKeyDown = (e) => {
                    if (e.key === 'ArrowRight') handleAnswer('correct');
                    if (e.key === 'ArrowLeft') handleAnswer('pass');
                };

                const handleOrientation = (e) => {
                    if (!settings.tiltEnabled) return;
                    if (isProcessingTilt.current) return;

                    // Beta: -180 to 180 (front/back tilt). 
                    // åœ¨æ©«å‘æ¨¡å¼(Landscape)ä¸‹ï¼Œé€šå¸¸çœ‹ Gamma æˆ– Beta ä¾æ“šé–å®šæ–¹å‘è€Œå®š
                    // ç°¡å–®åˆ¤æ–·ï¼šå‡è¨­æ‰‹æ©Ÿæ©«æ‹¿ï¼Œè¢å¹•æœå‘é¡é ­å¤–ã€‚
                    // å¾€ä¸‹é»é ­ (è¢å¹•æœåœ°) -> Beta/Gamma å€¼è®Šå‹•
                    // é€™è£¡ä½¿ç”¨ç°¡æ˜“é–¾å€¼ï¼Œæ ¹æ“šå¤§å¤šæ‰‹æ©Ÿæ©«å‘è¡Œç‚º
                    
                    const { beta, gamma } = e; 
                    
                    // é–¾å€¼è¨­å®š (é€™éœ€è¦ä¸€é»èª¿è©¦ï¼Œå–æ±ºæ–¼æ‰‹æ©Ÿæ€éº¼æ‹¿)
                    // å‡è¨­æ‰‹æ©Ÿæ©«æ‹¿è²¼é¡é ­: Gamma ~ +/-90, Beta ~ 0
                    // å¾€ä¸‹å€’ (é»é ­): Gamma çµ•å°å€¼è®Šå°? æˆ–æ˜¯ Beta è®Šå¤§?
                    
                    // ç°¡æ˜“é‚è¼¯ï¼š
                    // 1. å‹•ä½œåµæ¸¬å†·å» (Debounce)
                    // 2. åˆ¤æ–·æ˜¯å¦ã€Œæ­¸ä½ã€(å›åˆ°é¡é ­)
                    
                    // æ¸¬è©¦å€¼:
                    // å¾€ä¸‹ (Correct): gamma < 30 (or beta > 50 depending on orientation)
                    // å¾€ä¸Š (Pass): gamma > 150 (or beta < -50)
                    
                    // ç‚ºäº†ç°¡åŒ–ï¼Œé€™è£¡ç”¨ gamma ä½œç‚ºä¸»è¦åˆ¤æ–· (æ©«å‘æ¨¡å¼å¸¸è¦‹)
                    // æ³¨æ„ï¼šä¸åŒç€è¦½å™¨è»¸å‘å¯èƒ½ä¸åŒï¼Œé€™è£¡é‡å°å¸¸è¦‹æƒ…æ³å„ªåŒ–
                    
                    const tiltThreshold = 35; // å‚¾æ–œè§’åº¦

                    // æª¢æŸ¥æ˜¯å¦ã€Œæ­¸ä½ã€(å¤§æ¦‚å‚ç›´åœ°é¢)
                    if (Math.abs(gamma) > 60 && Math.abs(gamma) < 120) {
                        tiltNeutral.current = true;
                    }

                    if (tiltNeutral.current) {
                        // å¾€ä¸‹å€’ (è¢å¹•æœåœ°) -> Correct
                        // å¾ˆå¤šæ‰‹æ©Ÿæ©«æ‹¿æ™‚ï¼Œå¾€ä¸‹å€’ Gamma æœƒè¶¨è¿‘ 0
                        if (Math.abs(gamma) < tiltThreshold) {
                            isProcessingTilt.current = true;
                            tiltNeutral.current = false;
                            handleAnswer('correct');
                            setTimeout(() => isProcessingTilt.current = false, 1000); // 1ç§’å†·å»
                        }
                        // å¾€ä¸Šä»° (è¢å¹•æœå¤©) -> Pass
                        // å¾€ä¸Šä»° Gamma æœƒè¶¨è¿‘ 180
                        else if (Math.abs(gamma) > (180 - tiltThreshold)) {
                            isProcessingTilt.current = true;
                            tiltNeutral.current = false;
                            handleAnswer('pass');
                            setTimeout(() => isProcessingTilt.current = false, 1000);
                        }
                    }
                };

                window.addEventListener('keydown', handleKeyDown);
                if (settings.tiltEnabled) {
                    window.addEventListener('deviceorientation', handleOrientation);
                }

                return () => {
                    window.removeEventListener('keydown', handleKeyDown);
                    window.removeEventListener('deviceorientation', handleOrientation);
                };
            }, [gameState, settings.tiltEnabled, gameWords, currentIndex]); // Dependencies need to include state used in handleAnswer

            const handleAnswer = (status) => {
                // ä½¿ç”¨ Functional Update ç¢ºä¿æ‹¿åˆ°æœ€æ–° stateï¼Œé¿å…é–‰åŒ…å•é¡Œ
                setResults(prev => {
                     // é€™è£¡å¾ˆ tricky, å› ç‚ºæˆ‘å€‘éœ€è¦åœ¨é€™è£¡è§¸ç™¼ä¸‹ä¸€å€‹è©
                     // ä½†åœ¨ event listener è£¡ state å¯èƒ½æ˜¯èˆŠçš„
                     // æ‰€ä»¥æˆ‘å€‘åªæ›´æ–° resultsï¼Œç„¶å¾Œç”¨ useEffect ç›£è½ results é•·åº¦è®ŠåŒ–ä¾†æ›è©?
                     // æ›´å¥½çš„æ–¹æ³•ï¼šç›´æ¥ç”¨ ref å­˜ current index? 
                     // ç‚ºäº†ç°¡å–®ï¼Œæˆ‘å€‘é€™è£¡å…è¨±ä¾è³´æ”¹è®Šé‡æ–°ç¶å®š listener
                     return [...prev, { word: gameWords[currentIndex], status }];
                });
                
                playSound(status);
                if (status === 'correct') setScore(s => s + 1);

                if (currentIndex < gameWords.length - 1) {
                    setCurrentIndex(prev => prev + 1);
                } else {
                    // reshuffle logic if needed, simple end for now
                    // Loop deck logic:
                    setGameWords(prev => {
                        // ç°¡å–®é‡æ´—å‰©ä¸‹çš„
                        const nextIndex = currentIndex + 1;
                        if(nextIndex >= prev.length) return shuffleArray(prev);
                        return prev;
                    });
                    if (currentIndex >= gameWords.length - 1) {
                        setCurrentIndex(0);
                    }
                }
            };

            const returnToMenu = () => {
                setGameState('menu');
                setCurrentCategory(null);
            };

            // --- ç•«é¢æ¸²æŸ“ ---

            if (gameState === 'menu') {
                return (
                    <div className="min-h-screen pattern-dots flex flex-col text-gray-900 pb-10">
                        {/* Header */}
                        <header className="p-4 flex justify-between items-center sticky top-0 z-10 bg-[#FBF6EF]/95 backdrop-blur-sm border-b-[3px] border-black">
                            <div>
                                <h1 className="text-3xl font-titan text-[#FF4D8D] uppercase tracking-wider text-stroke drop-shadow-[2px_2px_0_rgba(0,0,0,1)]">
                                    Guess What?
                                </h1>
                                <span className="text-xs font-black bg-black text-white px-2 py-0.5 inline-block transform -rotate-2 rounded-sm">2025 EDITION</span>
                            </div>
                            <div className="flex space-x-2">
                                <button onClick={() => setShowTutorial(true)} className="p-2 bg-white brutal-shadow rounded-full active:translate-y-1 active:shadow-none transition-all">
                                    <Icons.HelpCircle />
                                </button>
                                <button onClick={() => setShowSettings(true)} className="p-2 bg-white brutal-shadow rounded-full active:translate-y-1 active:shadow-none transition-all">
                                    <Icons.Settings />
                                </button>
                            </div>
                        </header>

                        {/* Categories */}
                        <main className="flex-1 p-4 overflow-y-auto">
                            <div className="grid grid-cols-2 gap-4">
                                {CATEGORIES.map((cat) => (
                                    <button
                                        key={cat.id}
                                        onClick={() => startGame(cat)}
                                        className={`
                                            ${cat.color} ${cat.text} 
                                            relative h-40 rounded-2xl brutal-shadow
                                            flex flex-col items-center justify-center text-center p-2 group
                                            active:shadow-none active:translate-x-[4px] active:translate-y-[4px] transition-all
                                        `}
                                    >
                                        <div className="text-5xl mb-2 filter drop-shadow-md transform group-hover:scale-110 transition-transform">{cat.icon}</div>
                                        <h3 className="font-titan text-xl uppercase tracking-wide text-stroke-sm drop-shadow-md leading-5">{cat.title}</h3>
                                    </button>
                                ))}
                            </div>
                        </main>

                        {/* Settings Modal */}
                        {showSettings && (
                            <div className="fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 backdrop-blur-sm">
                                <div className="bg-[#FFEB3B] brutal-shadow rounded-2xl w-full max-w-sm p-6 relative border-[3px] border-black">
                                    <button onClick={() => setShowSettings(false)} className="absolute top-4 right-4 bg-white border-2 border-black rounded-full p-1 hover:bg-gray-100">
                                        <Icons.X />
                                    </button>
                                    <h3 className="text-2xl font-titan text-black mb-6 uppercase">Settings</h3>
                                    <div className="space-y-4">
                                        <div>
                                            <label className="block text-sm font-black text-black mb-2 uppercase">Time per Round</label>
                                            <div className="grid grid-cols-4 gap-2">
                                                {[30, 60, 90, 120].map(t => (
                                                    <button
                                                        key={t}
                                                        onClick={() => setSettings(s => ({ ...s, duration: t }))}
                                                        className={`
                                                            py-2 rounded-lg font-black border-2 border-black transition-all
                                                            ${settings.duration === t ? 'bg-black text-white' : 'bg-white text-black'}
                                                        `}
                                                    >
                                                        {t}s
                                                    </button>
                                                ))}
                                            </div>
                                        </div>
                                        {/* Tilt Toggle */}
                                        <div>
                                            <label className="block text-sm font-black text-black mb-2 uppercase">Motion Control</label>
                                            <div className="flex space-x-2">
                                                <button 
                                                    onClick={() => setSettings(s => ({ ...s, tiltEnabled: true }))}
                                                    className={`flex-1 py-2 rounded-lg font-black border-2 border-black ${settings.tiltEnabled ? 'bg-black text-white' : 'bg-white text-black'}`}
                                                >
                                                    ON
                                                </button>
                                                <button 
                                                    onClick={() => setSettings(s => ({ ...s, tiltEnabled: false }))}
                                                    className={`flex-1 py-2 rounded-lg font-black border-2 border-black ${!settings.tiltEnabled ? 'bg-black text-white' : 'bg-white text-black'}`}
                                                >
                                                    OFF
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <button onClick={() => setShowSettings(false)} className="mt-8 w-full bg-[#FF4D8D] text-white border-[3px] border-black py-3 rounded-xl font-titan text-xl uppercase brutal-shadow active:translate-y-[2px] active:shadow-none transition-all">
                                        Save
                                    </button>
                                </div>
                            </div>
                        )}

                        {/* Tutorial Modal */}
                        {showTutorial && (
                            <div className="fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 backdrop-blur-sm">
                                <div className="bg-white brutal-shadow rounded-2xl w-full max-w-sm p-6 text-center border-[3px] border-black">
                                    <div className="text-5xl mb-4 animate-bounce">ğŸ¤”</div>
                                    <h3 className="text-2xl font-titan mb-4">How to Play</h3>
                                    <div className="space-y-3 text-left bg-[#FBF6EF] p-4 rounded-xl border-2 border-black mb-6 font-bold text-sm">
                                        <p>1. é¸ä¸€å€‹ä¸»é¡Œ</p>
                                        <p>2. æ‰‹æ©Ÿæ©«å‘æ”¾é¡é ­</p>
                                        <p className="flex items-center"><Icons.Smartphone className="mr-2 w-4 h-4"/> é»é ­ (è¢å¹•æœåœ°) = ç­”å°</p>
                                        <p className="flex items-center"><Icons.Smartphone className="mr-2 w-4 h-4"/> æŠ¬é ­ (è¢å¹•æœå¤©) = è·³é</p>
                                        <p className="text-xs text-gray-500 mt-2">*iPhone è«‹å…è¨±å‹•ä½œæ¬Šé™</p>
                                    </div>
                                    <button onClick={() => setShowTutorial(false)} className="w-full bg-[#3B82F6] text-white border-[3px] border-black py-3 rounded-xl font-titan text-xl uppercase brutal-shadow active:translate-y-[2px] active:shadow-none transition-all">
                                        Got It!
                                    </button>
                                </div>
                            </div>
                        )}
                    </div>
                );
            }

            if (gameState === 'ready') {
                return (
                    <div className={`fixed inset-0 ${currentCategory.color} flex flex-col items-center justify-center text-white z-50`}>
                        <button onClick={returnToMenu} className="absolute top-6 left-6 p-3 bg-white text-black border-[3px] border-black rounded-full brutal-shadow active:translate-y-[2px] active:shadow-none transition-all">
                            <Icons.ArrowLeft />
                        </button>
                        
                        <div className="text-9xl mb-6 animate-bounce filter drop-shadow-[4px_4px_0_rgba(0,0,0,1)]">{currentCategory.icon}</div>
                        <h2 className="text-6xl font-titan mb-4 text-center px-4 uppercase tracking-wide text-stroke drop-shadow-[4px_4px_0_rgba(0,0,0,1)]">
                            {currentCategory.title}
                        </h2>
                        <div className="bg-black text-white px-6 py-2 rounded-lg font-bold transform -rotate-1 mb-12 border-2 border-white text-xl">
                            {currentCategory.description}
                        </div>
                        
                        <button onClick={handleStartPlaying} className="bg-white text-black px-12 py-6 rounded-2xl border-[4px] border-black text-4xl font-titan brutal-shadow active:translate-y-[4px] active:shadow-none transition-all flex items-center space-x-3">
                            <span className="fill-black"><Icons.Play /></span>
                            <span>START</span>
                        </button>
                        <p className="mt-8 font-black uppercase tracking-widest bg-black/20 px-4 py-1 rounded-full text-sm">æ‰‹æ©Ÿæ©«æ”¾é¡é ­ï¼Œé»é ­ç­”å°ï¼</p>
                    </div>
                );
            }

            if (gameState === 'playing') {
                return (
                    <div className={`fixed inset-0 ${currentCategory.color} flex flex-col z-50`}>
                        {/* Top Bar */}
                        <div className="flex justify-between items-center p-6 text-white relative z-10">
                            <button onClick={() => setGameState('results')} className="px-4 py-2 bg-black/20 rounded-lg font-bold border-2 border-white/50">
                                End Game
                            </button>
                            <div className="flex items-center space-x-2 font-black font-mono text-4xl bg-white text-black px-4 py-2 rounded-xl border-[3px] border-black brutal-shadow">
                                <span className={timeLeft <= 10 ? 'text-[#EF4444]' : ''}>{timeLeft}</span>
                            </div>
                        </div>

                        {/* Card Area */}
                        <div className="flex-1 flex items-center justify-center p-4 relative">
                            <div className="text-center w-full max-w-2xl">
                                <h2 className="text-7xl md:text-9xl font-titan text-white leading-tight tracking-tight text-stroke drop-shadow-[6px_6px_0_rgba(0,0,0,1)] select-none break-words">
                                    {gameWords[currentIndex]}
                                </h2>
                                <p className="text-white/80 mt-8 font-bold text-lg animate-pulse">
                                    {settings.tiltEnabled ? "é»é ­ = æ­£ç¢º  |  æŠ¬é ­ = è·³é" : "è«‹ä½¿ç”¨è¢å¹•æŒ‰éˆ•"}
                                </p>
                            </div>
                        </div>

                        {/* Controls */}
                        <div className="h-1/3 flex border-t-[4px] border-black">
                            <button onClick={() => handleAnswer('pass')} className="flex-1 bg-[#EF4444] active:bg-[#B91C1C] text-white flex flex-col items-center justify-center border-r-[4px] border-black relative group">
                                <div className="transform scale-150 mb-2 drop-shadow-md"><Icons.X /></div>
                                <span className="font-titan text-4xl uppercase tracking-wider text-stroke drop-shadow-md">PASS</span>
                                <span className="absolute bottom-4 text-sm font-bold opacity-50">(æˆ–æŒ‰ â†)</span>
                            </button>
                            
                            <button onClick={() => handleAnswer('correct')} className="flex-1 bg-[#10B981] active:bg-[#047857] text-white flex flex-col items-center justify-center relative group">
                                <div className="transform scale-150 mb-2 drop-shadow-md"><Icons.Check /></div>
                                <span className="font-titan text-4xl uppercase tracking-wider text-stroke drop-shadow-md">CORRECT</span>
                                <span className="absolute bottom-4 text-sm font-bold opacity-50">(æˆ–æŒ‰ â†’)</span>
                            </button>
                        </div>
                    </div>
                );
            }

            if (gameState === 'results') {
                return (
                    <div className="min-h-screen pattern-dots flex flex-col z-50 bg-[#FBF6EF]">
                        <div className={`${currentCategory.color} text-white p-8 rounded-b-[3rem] border-b-[4px] border-black shadow-xl flex flex-col items-center relative overflow-hidden`}>
                           <div className="text-[#FFEB3B] drop-shadow-[4px_4px_0_rgba(0,0,0,1)] transform scale-150 mb-4"><Icons.Trophy /></div>
                           <h2 className="text-3xl font-black uppercase tracking-widest bg-black px-4 py-1 transform -rotate-2 rounded-sm mb-4">Time's Up!</h2>
                           <div className="text-9xl font-titan text-stroke drop-shadow-[6px_6px_0_rgba(0,0,0,1)]">{score}</div>
                           <p className="font-black uppercase tracking-wider opacity-90 mt-2 text-xl">Correct Answers</p>
                        </div>

                        <div className="flex-1 p-6 overflow-y-auto">
                            <h3 className="font-titan text-3xl text-black mb-4 uppercase">Recap</h3>
                            <div className="space-y-3 pb-24">
                                {results.map((res, idx) => (
                                    <div key={idx} className="flex items-center justify-between p-4 bg-white rounded-xl border-[3px] border-black brutal-shadow">
                                        <span className="font-bold text-xl text-black font-nunito">{res.word}</span>
                                        {res.status === 'correct' ? (
                                            <div className="bg-[#10B981] text-white p-2 rounded-lg border-2 border-black"><Icons.Check /></div>
                                        ) : (
                                            <div className="bg-[#EF4444] text-white p-2 rounded-lg border-2 border-black"><Icons.X /></div>
                                        )}
                                    </div>
                                ))}
                            </div>
                        </div>

                        <div className="p-4 bg-white border-t-[4px] border-black sticky bottom-0 flex space-x-4">
                            <button onClick={returnToMenu} className="flex-1 py-4 bg-gray-100 text-black border-[3px] border-black rounded-xl font-titan text-xl uppercase tracking-wide active:translate-y-[2px] transition-all">
                                Menu
                            </button>
                            <button onClick={() => startGame(currentCategory)} className="flex-1 py-4 bg-[#FFEB3B] text-black border-[3px] border-black rounded-xl font-titan text-xl uppercase tracking-wide brutal-shadow active:translate-y-[2px] active:shadow-none transition-all flex items-center justify-center space-x-2">
                                <span>Replay</span>
                            </button>
                        </div>
                    </div>
                );
            }
            return null;
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
